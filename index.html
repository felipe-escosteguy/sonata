<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Personagens - Sonata</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e4e4e4;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        h1 {
            font-size: 2.5em;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 10px;
        }

        .subtitle {
            color: #b8b8b8;
            font-size: 1.1em;
        }

        .class-selection {
            margin-bottom: 40px;
        }

        .class-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .class-card {
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .class-card:hover {
            transform: translateY(-5px);
            border-color: #ffd700;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.3);
        }

        .class-card.selected {
            border-color: #ffd700;
            background: rgba(255, 215, 0, 0.15);
        }

        .class-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .class-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 5px;
        }

        .class-domains {
            font-size: 0.9em;
            color: #b8b8b8;
        }

        .character-sheet {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            display: none;
        }

        .character-sheet.active {
            display: block;
        }

        .section {
            margin-bottom: 30px;
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 10px;
        }

        .section-title {
            font-size: 1.5em;
            color: #ffd700;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-size: 0.9em;
            color: #b8b8b8;
            margin-bottom: 5px;
            font-weight: 500;
        }

        input[type="text"],
        input[type="number"],
        select,
        textarea {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            padding: 10px;
            color: #e4e4e4;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #ffd700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }

        .attributes-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 15px;
        }

        .attribute-box {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .attribute-name {
            font-size: 0.85em;
            color: #b8b8b8;
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .attribute-value {
            font-size: 2em;
            font-weight: bold;
            color: #ffd700;
        }

        .attribute-input {
            width: 60px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
        }

        .calculated-value {
            background: rgba(255, 215, 0, 0.1);
            border: 2px solid rgba(255, 215, 0, 0.3);
            font-weight: bold;
            color: #ffd700;
        }

        .weapons-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .weapon-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
        }

        .weapon-title {
            color: #ffd700;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .features-list {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
        }

        .feature-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .feature-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .feature-name {
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 5px;
        }

        .feature-description {
            font-size: 0.9em;
            line-height: 1.6;
            color: #c8c8c8;
        }

        .gold-tracker {
            display: flex;
            gap: 20px;
            align-items: center;
            justify-content: center;
        }

        .gold-box {
            text-align: center;
        }

        .gold-label {
            font-size: 0.9em;
            color: #b8b8b8;
            margin-bottom: 5px;
        }

        .gold-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #ffd700;
        }

        .btn {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #1a1a2e;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.5);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #e4e4e4;
        }

        .actions {
            text-align: center;
            margin-top: 40px;
        }

        .info-box {
            background: rgba(100, 150, 255, 0.1);
            border-left: 4px solid #6496ff;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .warning-box {
            background: rgba(255, 193, 7, 0.1);
            border-left: 4px solid #ffc107;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .attributes-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            h1 {
                font-size: 1.8em;
            }
        }

        .inventory-grid {
            display: grid;
            gap: 10px;
        }

        .inventory-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .remove-btn {
            background: rgba(255, 100, 100, 0.3);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .add-btn {
            background: rgba(100, 255, 100, 0.3);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚öîÔ∏è Gerador de Personagens - Sonata ‚öîÔ∏è</h1>
            <p class="subtitle">Can√ß√µes do Mar Interno</p>
        </header>

        <div class="class-selection">
            <div class="section">
                <h2 class="section-title">Escolha sua Classe</h2>
                <div class="class-grid" id="classGrid"></div>
            </div>
        </div>

        <div class="character-sheet" id="characterSheet">
            <!-- Informa√ß√µes B√°sicas -->
            <div class="section">
                <h2 class="section-title">Informa√ß√µes B√°sicas</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="charName">Nome do Personagem</label>
                        <input type="text" id="charName" placeholder="Digite o nome">
                    </div>
                    <div class="form-group">
                        <label for="ancestry">Ancestralidade</label>
                        <input type="text" id="ancestry" placeholder="Ex: Humano">
                    </div>
                    <div class="form-group">
                        <label for="community">Comunidade</label>
                        <input type="text" id="community" placeholder="Ex: Val Cadma">
                    </div>
                    <div class="form-group">
                        <label for="pronouns">Pronomes</label>
                        <input type="text" id="pronouns" placeholder="Ex: ele/dele">
                    </div>
                    <div class="form-group">
                        <label for="subclass">Subclasse</label>
                        <input type="text" id="subclass" placeholder="Subclasse">
                    </div>
                    <div class="form-group">
                        <label for="level">N√≠vel</label>
                        <input type="number" id="level" value="1" min="1" max="10">
                    </div>
                </div>
            </div>

            <!-- Atributos -->
            <div class="section">
                <h2 class="section-title">Atributos</h2>
                <div class="info-box">
                    üí° Os valores sugeridos j√° foram preenchidos, mas voc√™ pode alter√°-los conforme desejar.
                </div>
                <div class="attributes-grid" id="attributesGrid"></div>
            </div>

            <!-- Valores Calculados -->
            <div class="section">
                <h2 class="section-title">Valores de Combate</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="evasion">Evas√£o</label>
                        <input type="number" id="evasion" class="calculated-value" readonly>
                    </div>
                    <div class="form-group">
                        <label for="proficiency">Profici√™ncia</label>
                        <input type="number" id="proficiency" class="calculated-value" readonly>
                    </div>
                    <div class="form-group">
                        <label for="armorScore">Armadura (Pontua√ß√£o)</label>
                        <input type="number" id="armorScore" class="calculated-value" readonly>
                    </div>
                    <div class="form-group">
                        <label for="threshold1">Limiar 1 (Dano Menor)</label>
                        <input type="number" id="threshold1" class="calculated-value" readonly>
                    </div>
                    <div class="form-group">
                        <label for="threshold2">Limiar 2 (Dano Maior)</label>
                        <input type="number" id="threshold2" class="calculated-value" readonly>
                    </div>
                    <div class="form-group">
                        <label for="threshold3">Limiar 3 (Dano Severo)</label>
                        <input type="number" id="threshold3" class="calculated-value" readonly>
                    </div>
                </div>
            </div>

            <!-- Armas -->
            <div class="section">
                <h2 class="section-title">Armas</h2>
                <div class="weapons-grid" id="weaponsGrid"></div>
            </div>

            <!-- Armadura -->
            <div class="section">
                <h2 class="section-title">Armadura</h2>
                <div id="armorSection"></div>
            </div>

            <!-- Caracter√≠sticas de Classe -->
            <div class="section">
                <h2 class="section-title">Caracter√≠sticas de Classe</h2>
                <div class="features-list" id="classFeatures"></div>
            </div>

            <!-- Invent√°rio -->
            <div class="section">
                <h2 class="section-title">Invent√°rio Inicial</h2>
                <div class="inventory-grid" id="inventoryList"></div>
                <button class="add-btn" onclick="addInventoryItem()">+ Adicionar Item</button>
            </div>

            <!-- Ouro -->
            <div class="section">
                <h2 class="section-title">Riqueza</h2>
                <div class="gold-tracker">
                    <div class="gold-box">
                        <div class="gold-label">Punhados (Handfuls)</div>
                        <input type="number" class="gold-value attribute-input" id="goldHandfuls" value="1" min="0">
                    </div>
                    <div class="gold-box">
                        <div class="gold-label">Sacos (Bags)</div>
                        <input type="number" class="gold-value attribute-input" id="goldBags" value="0" min="0">
                    </div>
                    <div class="gold-box">
                        <div class="gold-label">Ba√∫ (Chest)</div>
                        <input type="number" class="gold-value attribute-input" id="goldChest" value="0" min="0">
                    </div>
                </div>
                <div class="info-box" style="margin-top: 20px;">
                    üí∞ Convers√£o: 10 Punhados = 1 Saco | 10 Sacos = 1 Ba√∫
                </div>
            </div>

            <!-- Experi√™ncias -->
            <div class="section">
                <h2 class="section-title">Experi√™ncias</h2>
                <div class="info-box">
                    Experi√™ncias representam as habilidades e conhecimentos espec√≠ficos do seu personagem. 
                    Comece com 2 Experi√™ncias em +2. Trabalhe com o Mestre para cri√°-las.
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Experi√™ncia 1</label>
                        <input type="text" id="exp1" placeholder="Ex: Combate Naval">
                    </div>
                    <div class="form-group">
                        <label>Experi√™ncia 2</label>
                        <input type="text" id="exp2" placeholder="Ex: Conhecimento de Obsidiana">
                    </div>
                </div>
            </div>

            <!-- Descri√ß√£o do Personagem -->
            <div class="section">
                <h2 class="section-title">Descri√ß√£o do Personagem</h2>
                <div class="form-group">
                    <label for="description">Apar√™ncia e Personalidade</label>
                    <textarea id="description" placeholder="Descreva a apar√™ncia, atitude e hist√≥rico do seu personagem..."></textarea>
                </div>
            </div>

            <!-- A√ß√µes -->
            <div class="actions">
                <button class="btn" onclick="downloadPDF()">üìÑ Baixar Ficha em PDF</button>
                <button class="btn btn-secondary" onclick="resetForm()">üîÑ Resetar Ficha</button>
            </div>
        </div>
    </div>

    <script>
        const classes = {
            mago: {
                name: "Mago",
                icon: "üîÆ",
                domains: "Codex & Esplendor",
                attributes: { agilidade: -1, forca: 0, destreza: 0, instinto: 1, presenca: 1, conhecimento: 2 },
                evasion: 11,
                proficiency: 2,
                primaryWeapon: {
                    name: "Cajado Grande",
                    trait: "Conhecimento",
                    range: "Muito Distante",
                    damage: "d6",
                    type: "mag",
                    features: "Duas M√£os, Poderoso: Em ataque bem-sucedido, role um dado de dano adicional e descarte o menor resultado"
                },
                armor: {
                    name: "Armadura de Couro",
                    thresholds: [6, 13, 0],
                    score: 3
                },
                features: [
                    {
                        name: "Prestidigita√ß√£o",
                        description: "Voc√™ pode realizar efeitos m√°gicos sutis e inofensivos √† vontade. Por exemplo, pode mudar a cor de um objeto, criar um cheiro, acender uma vela, fazer um objeto pequeno flutuar, iluminar uma sala ou reparar um objeto pequeno."
                    },
                    {
                        name: "Padr√µes Estranhos",
                        description: "Escolha um n√∫mero entre 1 e 12. Quando rolar esse n√∫mero no Dado de Dualidade, ganhe uma Esperan√ßa ou limpe um Estresse. Voc√™ pode mudar este n√∫mero quando fizer um descanso longo."
                    }
                ],
                inventory: [
                    "Uma tocha",
                    "15 metros de corda",
                    "Suprimentos b√°sicos",
                    "Um punhado de ouro",
                    "Po√ß√£o Menor de Vida OU Po√ß√£o Menor de Vigor",
                    "Um livro que voc√™ est√° tentando traduzir OU um pequeno familiar elemental inofensivo"
                ]
            },
            guerreiro: {
                name: "Guerreiro",
                icon: "‚öîÔ∏è",
                domains: "L√¢mina & Osso",
                attributes: { agilidade: 2, forca: 1, destreza: 0, instinto: 1, presenca: -1, conhecimento: 0 },
                evasion: 11,
                proficiency: 2,
                primaryWeapon: {
                    name: "Espada Longa",
                    trait: "Agilidade",
                    range: "Corpo a Corpo",
                    damage: "d8+3",
                    type: "f√≠s",
                    features: "Duas M√£os"
                },
                armor: {
                    name: "Cota de Malha",
                    thresholds: [7, 15, 0],
                    score: 4,
                    features: "Pesada: -1 √† Evas√£o"
                },
                features: [
                    {
                        name: "Ataque de Oportunidade",
                        description: "Quando um advers√°rio dentro do alcance Corpo a Corpo tentar sair desse alcance, fa√ßa uma rolagem de rea√ß√£o usando um atributo de sua escolha contra a Dificuldade dele. Escolha um efeito em sucesso, ou dois se obter sucesso cr√≠tico: ‚Ä¢ Eles n√£o podem se mover de onde est√£o ‚Ä¢ Voc√™ causa dano igual ao dano da sua arma prim√°ria ‚Ä¢ Voc√™ se move com eles"
                    },
                    {
                        name: "Treinamento em Combate",
                        description: "Voc√™ ignora carga ao equipar armas. Quando causa dano f√≠sico, ganha um b√¥nus na rolagem de dano igual ao seu n√≠vel."
                    }
                ],
                inventory: [
                    "Uma tocha",
                    "15 metros de corda",
                    "Suprimentos b√°sicos",
                    "Um punhado de ouro",
                    "Po√ß√£o Menor de Vida OU Po√ß√£o Menor de Vigor",
                    "O desenho de um amor OU uma pedra de amolar"
                ]
            },
            feiticeiro: {
                name: "Feiticeiro",
                icon: "‚ö°",
                domains: "Arcana & Meia-Noite",
                attributes: { agilidade: 0, forca: -1, destreza: 1, instinto: 2, presenca: 1, conhecimento: 0 },
                evasion: 10,
                proficiency: 2,
                primaryWeapon: {
                    name: "Cajado Duplo",
                    trait: "Instinto",
                    range: "Distante",
                    damage: "d6+3",
                    type: "mag",
                    features: "Duas M√£os"
                },
                armor: {
                    name: "Gib√£o Acolchoado",
                    thresholds: [5, 11, 0],
                    score: 3,
                    features: "Flex√≠vel: +1 √† Evas√£o"
                },
                features: [
                    {
                        name: "Sentido Arcano",
                        description: "Voc√™ pode sentir a presen√ßa de pessoas e objetos m√°gicos dentro do alcance Pr√≥ximo."
                    },
                    {
                        name: "Ilus√£o Menor",
                        description: "Fa√ßa uma Rolagem de Conjura√ß√£o (10). Em sucesso, voc√™ cria uma ilus√£o visual menor n√£o maior que voc√™ mesmo dentro do alcance Pr√≥ximo. Esta ilus√£o √© convincente para qualquer um a Pr√≥ximo ou mais distante."
                    },
                    {
                        name: "Canalizar Poder Bruto",
                        description: "Uma vez por descanso longo, voc√™ pode colocar uma carta de dom√≠nio da sua carga no cofre e escolher: ‚Ä¢ Ganhar Esperan√ßa igual ao n√≠vel da carta ‚Ä¢ Melhorar uma magia que causa dano, ganhando b√¥nus na rolagem de dano igual a duas vezes o n√≠vel da carta"
                    }
                ],
                inventory: [
                    "Uma tocha",
                    "15 metros de corda",
                    "Suprimentos b√°sicos",
                    "Um punhado de ouro",
                    "Po√ß√£o Menor de Vida OU Po√ß√£o Menor de Vigor",
                    "Um orbe sussurrante OU uma heran√ßa de fam√≠lia"
                ]
            },
            serafim: {
                name: "Serafim",
                icon: "üëº",
                domains: "Esplendor & Valor",
                attributes: { agilidade: 0, forca: 2, destreza: 0, instinto: 1, presenca: 1, conhecimento: -1 },
                evasion: 9,
                proficiency: 2,
                primaryWeapon: {
                    name: "Machado Sagrado",
                    trait: "For√ßa",
                    range: "Corpo a Corpo",
                    damage: "d8+1",
                    type: "mag",
                    features: "Uma M√£o"
                },
                secondaryWeapon: {
                    name: "Escudo Redondo",
                    trait: "For√ßa",
                    range: "Corpo a Corpo",
                    damage: "d4",
                    type: "f√≠s",
                    features: "Uma M√£o, Protetor: +1 √† Pontua√ß√£o de Armadura"
                },
                armor: {
                    name: "Cota de Malha",
                    thresholds: [7, 15, 0],
                    score: 4,
                    features: "Pesada: -1 √† Evas√£o"
                },
                features: [
                    {
                        name: "Dados de Prece",
                        description: "No in√≠cio de cada sess√£o, role um n√∫mero de d4s igual ao atributo de Conjura√ß√£o da sua subclasse e coloque-os nesta ficha no espa√ßo fornecido. Estes s√£o seus Dados de Prece. Voc√™ pode gastar qualquer n√∫mero de Dados de Prece para ajudar a si mesmo ou um aliado dentro do alcance Distante. Pode usar o valor de um dado gasto para reduzir dano recebido, adicionar ao resultado de uma rolagem ap√≥s ela ser feita, ou ganhar Esperan√ßa igual ao resultado. No final de cada sess√£o, limpe todos os Dados de Prece n√£o gastos."
                    }
                ],
                inventory: [
                    "Uma tocha",
                    "15 metros de corda",
                    "Suprimentos b√°sicos",
                    "Um punhado de ouro",
                    "Po√ß√£o Menor de Vida OU Po√ß√£o Menor de Vigor",
                    "Um pacote de oferendas OU um s√≠mbolo do seu deus"
                ]
            },
            ladino: {
                name: "Ladino",
                icon: "üó°Ô∏è",
                domains: "Meia-Noite & Gra√ßa",
                attributes: { agilidade: 1, forca: -1, destreza: 2, instinto: 0, presenca: 1, conhecimento: 0 },
                evasion: 12,
                proficiency: 2,
                primaryWeapon: {
                    name: "Adaga",
                    trait: "Destreza",
                    range: "Corpo a Corpo",
                    damage: "d8+1",
                    type: "f√≠s",
                    features: "Uma M√£o"
                },
                secondaryWeapon: {
                    name: "Adaga Pequena",
                    trait: "Destreza",
                    range: "Corpo a Corpo",
                    damage: "d8",
                    type: "f√≠s",
                    features: "Uma M√£o, Pareado: +2 ao dano da arma prim√°ria contra alvos dentro do alcance Corpo a Corpo"
                },
                armor: {
                    name: "Gib√£o Acolchoado",
                    thresholds: [5, 11, 0],
                    score: 3,
                    features: "Flex√≠vel: +1 √† Evas√£o"
                },
                features: [
                    {
                        name: "Encoberto",
                        description: "Sempre que voc√™ estaria Oculto, est√° Encoberto. Al√©m dos benef√≠cios da condi√ß√£o Oculto, enquanto Encoberto voc√™ permanece invis√≠vel se estiver parado quando um advers√°rio se mover para onde normalmente o veria. Ap√≥s fazer um ataque ou terminar um movimento na linha de vis√£o de um advers√°rio, voc√™ n√£o est√° mais Encoberto."
                    },
                    {
                        name: "Ataque Furtivo",
                        description: "Quando voc√™ tem sucesso em um ataque enquanto Encoberto ou enquanto um aliado est√° dentro do alcance Corpo a Corpo do seu alvo, adicione um n√∫mero de d6s igual √† sua gradua√ß√£o √† sua rolagem de dano. N√≠vel 1 √© Gradua√ß√£o 1, N√≠veis 2-4 s√£o Gradua√ß√£o 2, N√≠veis 5-7 s√£o Gradua√ß√£o 3, N√≠veis 8-10 s√£o Gradua√ß√£o 4."
                    }
                ],
                inventory: [
                    "Uma tocha",
                    "15 metros de corda",
                    "Suprimentos b√°sicos",
                    "Um punhado de ouro",
                    "Po√ß√£o Menor de Vida OU Po√ß√£o Menor de Vigor",
                    "Um conjunto de ferramentas de falsifica√ß√£o OU um gancho de escalada"
                ]
            },
            patrulheiro: {
                name: "Patrulheiro",
                icon: "üèπ",
                domains: "Osso & S√°bio",
                attributes: { agilidade: 2, forca: 0, destreza: 1, instinto: 1, presenca: -1, conhecimento: 0 },
                evasion: 12,
                proficiency: 2,
                primaryWeapon: {
                    name: "Arco Curto",
                    trait: "Agilidade",
                    range: "Distante",
                    damage: "d6+3",
                    type: "f√≠s",
                    features: "Duas M√£os"
                },
                armor: {
                    name: "Armadura de Couro",
                    thresholds: [6, 13, 0],
                    score: 3
                },
                features: [
                    {
                        name: "Foco do Patrulheiro",
                        description: "Gaste uma Esperan√ßa e fa√ßa um ataque contra um alvo. Em sucesso, cause o dano normal do ataque e torne temporariamente o alvo seu Foco. At√© que este recurso termine ou voc√™ fa√ßa de outra criatura seu Foco, voc√™ ganha os seguintes benef√≠cios contra seu Foco: ‚Ä¢ Voc√™ sabe precisamente em que dire√ß√£o eles est√£o ‚Ä¢ Quando causar dano a eles, eles devem marcar um Estresse ‚Ä¢ Quando falhar em um ataque contra eles, pode terminar seu Foco do Patrulheiro para rerolar seus Dados de Dualidade"
                    }
                ],
                inventory: [
                    "Uma tocha",
                    "15 metros de corda",
                    "Suprimentos b√°sicos",
                    "Um punhado de ouro",
                    "Po√ß√£o Menor de Vida OU Po√ß√£o Menor de Vigor",
                    "Um trof√©u da sua primeira ca√ßa OU uma b√∫ssola aparentemente quebrada"
                ]
            },
            guardiao: {
                name: "Guardi√£o",
                icon: "üõ°Ô∏è",
                domains: "Valor & L√¢mina",
                attributes: { agilidade: 1, forca: 2, destreza: -1, instinto: 0, presenca: 1, conhecimento: 0 },
                evasion: 9,
                proficiency: 2,
                primaryWeapon: {
                    name: "Machado de Batalha",
                    trait: "For√ßa",
                    range: "Corpo a Corpo",
                    damage: "d10+3",
                    type: "f√≠s",
                    features: "Duas M√£os"
                },
                armor: {
                    name: "Cota de Malha",
                    thresholds: [7, 15, 0],
                    score: 4,
                    features: "Pesada: -1 √† Evas√£o"
                },
                features: [
                    {
                        name: "Impar√°vel",
                        description: "Uma vez por descanso longo, voc√™ pode se tornar Impar√°vel. Voc√™ ganha um Dado Impar√°vel. No n√≠vel 1, seu Dado Impar√°vel √© um d4. Coloque-o nesta ficha come√ßando com o valor 1 virado para cima. Ap√≥s fazer uma rolagem de dano que causa 1 ou mais Pontos de Vida a um alvo, aumente o valor do Dado Impar√°vel em um. Quando o valor do dado exceder seu valor m√°ximo ou quando a cena terminar, remova o dado e saia de Impar√°vel. No n√≠vel 5, seu Dado Impar√°vel aumenta para d6. Enquanto Impar√°vel: ‚Ä¢ Voc√™ reduz a severidade do dano f√≠sico em um limiar (Severo para Maior, Maior para Menor, Menor para Nenhum) ‚Ä¢ Voc√™ adiciona o valor atual do Dado Impar√°vel √† sua rolagem de dano ‚Ä¢ Voc√™ n√£o pode ficar Contido ou Vulner√°vel"
                    }
                ],
                inventory: [
                    "Uma tocha",
                    "15 metros de corda",
                    "Suprimentos b√°sicos",
                    "Um punhado de ouro",
                    "Po√ß√£o Menor de Vida OU Po√ß√£o Menor de Vigor",
                    "Um totem do seu mentor OU uma chave secreta"
                ]
            },
            druida: {
                name: "Druida",
                icon: "üåø",
                domains: "S√°bio & Arcana",
                attributes: { agilidade: 1, forca: 0, destreza: 1, instinto: 2, presenca: -1, conhecimento: 0 },
                evasion: 10,
                proficiency: 2,
                primaryWeapon: {
                    name: "Cajado Curto",
                    trait: "Instinto",
                    range: "Pr√≥ximo",
                    damage: "d8+1",
                    type: "mag",
                    features: "Uma M√£o"
                },
                secondaryWeapon: {
                    name: "Escudo Redondo",
                    trait: "For√ßa",
                    range: "Corpo a Corpo",
                    damage: "d4",
                    type: "f√≠s",
                    features: "Uma M√£o, Protetor: +1 √† Pontua√ß√£o de Armadura"
                },
                armor: {
                    name: "Armadura de Couro",
                    thresholds: [6, 13, 0],
                    score: 3
                },
                features: [
                    {
                        name: "Forma Bestial",
                        description: "Marque um Estresse para se transformar magicamente em uma criatura da sua gradua√ß√£o ou menor da lista de Formas Bestiais. Voc√™ pode sair desta forma a qualquer momento. Enquanto transformado, n√£o pode usar armas ou conjurar magias de cartas de dom√≠nio, mas ainda pode usar outros recursos ou habilidades que tem acesso. Magias conjuradas antes de transformar permanecem ativas e duram sua dura√ß√£o normal, e voc√™ pode falar e se comunicar normalmente. Al√©m disso, ganha os recursos da Forma Bestial, adiciona o b√¥nus de Evas√£o dela √† sua Evas√£o, e usa o atributo especificado nas estat√≠sticas para seu ataque. Enquanto em Forma Bestial, sua armadura se torna parte do seu corpo e voc√™ marca Espa√ßos de Armadura normalmente; quando sair da Forma Bestial, esses Espa√ßos de Armadura marcados permanecem marcados. Se marcar seu √∫ltimo Ponto de Vida, automaticamente sai desta forma."
                    },
                    {
                        name: "Toque Selvagem",
                        description: "Voc√™ pode realizar efeitos sutis e inofensivos que envolvem natureza‚Äîcomo fazer uma flor crescer rapidamente, invocar uma leve brisa, ou iniciar uma fogueira‚Äî√† vontade."
                    }
                ],
                inventory: [
                    "Uma tocha",
                    "15 metros de corda",
                    "Suprimentos b√°sicos",
                    "Um punhado de ouro",
                    "Po√ß√£o Menor de Vida OU Po√ß√£o Menor de Vigor",
                    "Um pequeno saco de pedras e ossos OU um pingente estranho encontrado na terra"
                ]
            },
            bardo: {
                name: "Bardo",
                icon: "üéµ",
                domains: "Gra√ßa & Codex",
                attributes: { agilidade: 0, forca: -1, destreza: 1, instinto: 0, presenca: 2, conhecimento: 1 },
                evasion: 10,
                proficiency: 2,
                primaryWeapon: {
                    name: "Estoque",
                    trait: "Presen√ßa",
                    range: "Corpo a Corpo",
                    damage: "d8",
                    type: "f√≠s",
                    features: "Uma M√£o, R√°pido: Ao fazer um ataque, pode marcar um Estresse para mirar em outra criatura dentro do alcance"
                },
                secondaryWeapon: {
                    name: "Adaga Pequena",
                    trait: "Destreza",
                    range: "Corpo a Corpo",
                    damage: "d8",
                    type: "f√≠s",
                    features: "Uma M√£o, Pareado: +2 ao dano da arma prim√°ria contra alvos dentro do alcance Corpo a Corpo"
                },
                armor: {
                    name: "Gib√£o Acolchoado",
                    thresholds: [5, 11, 0],
                    score: 3,
                    features: "Flex√≠vel: +1 √† Evas√£o"
                },
                features: [
                    {
                        name: "Reunir",
                        description: "Uma vez por sess√£o, descreva como voc√™ re√∫ne o grupo e d√™ a si mesmo e a cada um dos seus aliados um Dado de Reuni√£o. No n√≠vel 1, seu Dado de Reuni√£o √© um d6. Um PJ pode gastar seu Dado de Reuni√£o para rol√°-lo, adicionando o resultado √† sua rolagem de a√ß√£o, rolagem de rea√ß√£o, rolagem de dano, ou para limpar um n√∫mero de Estresse igual ao resultado. No final de cada sess√£o, limpe todos os Dados de Reuni√£o n√£o gastos. No n√≠vel 5, seu Dado de Reuni√£o aumenta para d8."
                    }
                ],
                inventory: [
                    "Uma tocha",
                    "15 metros de corda",
                    "Suprimentos b√°sicos",
                    "Um punhado de ouro",
                    "Po√ß√£o Menor de Vida OU Po√ß√£o Menor de Vigor",
                    "Um romance OU uma carta nunca aberta"
                ]
            }
        };

        let selectedClass = null;
        let currentData = {};

        // Inicializar grade de classes
        function initClassGrid() {
            const grid = document.getElementById('classGrid');
            for (let [key, classData] of Object.entries(classes)) {
                const card = document.createElement('div');
                card.className = 'class-card';
                card.onclick = () => selectClass(key);
                card.innerHTML = `
                    <div class="class-icon">${classData.icon}</div>
                    <div class="class-name">${classData.name}</div>
                    <div class="class-domains">${classData.domains}</div>
                `;
                grid.appendChild(card);
            }
        }

        function selectClass(classKey) {
            selectedClass = classKey;
            const classData = classes[classKey];
            
            // Atualizar UI de sele√ß√£o
            document.querySelectorAll('.class-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // Mostrar ficha
            document.getElementById('characterSheet').classList.add('active');
            
            // Preencher dados
            populateSheet(classData);
            
            // Scroll suave
            document.getElementById('characterSheet').scrollIntoView({ behavior: 'smooth' });
        }

        function populateSheet(classData) {
            // Limpar subclasse
            document.getElementById('subclass').value = classData.domains;
            
            // Atributos
            const attributesGrid = document.getElementById('attributesGrid');
            attributesGrid.innerHTML = '';
            
            const attributeNames = {
                agilidade: 'Agilidade',
                forca: 'For√ßa',
                destreza: 'Destreza',
                instinto: 'Instinto',
                presenca: 'Presen√ßa',
                conhecimento: 'Conhecimento'
            };
            
            for (let [key, name] of Object.entries(attributeNames)) {
                const value = classData.attributes[key];
                const box = document.createElement('div');
                box.className = 'attribute-box';
                box.innerHTML = `
                    <div class="attribute-name">${name}</div>
                    <input type="number" class="attribute-input" id="attr_${key}" 
                           value="${value}" min="-2" max="3" 
                           onchange="calculateValues()">
                `;
                attributesGrid.appendChild(box);
            }
            
            // Valores calculados iniciais
            document.getElementById('proficiency').value = classData.proficiency;
            calculateValues();
            
            // Armas
            const weaponsGrid = document.getElementById('weaponsGrid');
            weaponsGrid.innerHTML = `
                <div class="weapon-card">
                    <div class="weapon-title">Arma Prim√°ria</div>
                    <div class="form-group">
                        <label>Nome</label>
                        <input type="text" id="primaryWeaponName" value="${classData.primaryWeapon.name}">
                    </div>
                    <div class="form-group">
                        <label>Atributo</label>
                        <input type="text" id="primaryWeaponTrait" value="${classData.primaryWeapon.trait}">
                    </div>
                    <div class="form-group">
                        <label>Alcance</label>
                        <input type="text" id="primaryWeaponRange" value="${classData.primaryWeapon.range}">
                    </div>
                    <div class="form-group">
                        <label>Dano</label>
                        <input type="text" id="primaryWeaponDamage" value="${classData.primaryWeapon.damage}">
                    </div>
                    <div class="form-group">
                        <label>Tipo</label>
                        <input type="text" id="primaryWeaponType" value="${classData.primaryWeapon.type}">
                    </div>
                    <div class="form-group">
                        <label>Caracter√≠sticas</label>
                        <textarea id="primaryWeaponFeatures">${classData.primaryWeapon.features}</textarea>
                    </div>
                </div>
            `;
            
            if (classData.secondaryWeapon) {
                weaponsGrid.innerHTML += `
                    <div class="weapon-card">
                        <div class="weapon-title">Arma Secund√°ria</div>
                        <div class="form-group">
                            <label>Nome</label>
                            <input type="text" id="secondaryWeaponName" value="${classData.secondaryWeapon.name}">
                        </div>
                        <div class="form-group">
                            <label>Atributo</label>
                            <input type="text" id="secondaryWeaponTrait" value="${classData.secondaryWeapon.trait}">
                        </div>
                        <div class="form-group">
                            <label>Alcance</label>
                            <input type="text" id="secondaryWeaponRange" value="${classData.secondaryWeapon.range}">
                        </div>
                        <div class="form-group">
                            <label>Dano</label>
                            <input type="text" id="secondaryWeaponDamage" value="${classData.secondaryWeapon.damage}">
                        </div>
                        <div class="form-group">
                            <label>Tipo</label>
                            <input type="text" id="secondaryWeaponType" value="${classData.secondaryWeapon.type}">
                        </div>
                        <div class="form-group">
                            <label>Caracter√≠sticas</label>
                            <textarea id="secondaryWeaponFeatures">${classData.secondaryWeapon.features}</textarea>
                        </div>
                    </div>
                `;
            }
            
            // Armadura
            const armorSection = document.getElementById('armorSection');
            armorSection.innerHTML = `
                <div class="weapon-card">
                    <div class="form-group">
                        <label>Nome da Armadura</label>
                        <input type="text" id="armorName" value="${classData.armor.name}">
                    </div>
                    <div class="form-group">
                        <label>Caracter√≠sticas</label>
                        <textarea id="armorFeatures">${classData.armor.features || 'Nenhuma caracter√≠stica especial'}</textarea>
                    </div>
                </div>
            `;
            
            // Caracter√≠sticas de classe
            const featuresDiv = document.getElementById('classFeatures');
            featuresDiv.innerHTML = classData.features.map(feature => `
                <div class="feature-item">
                    <div class="feature-name">${feature.name}</div>
                    <div class="feature-description">${feature.description}</div>
                </div>
            `).join('');
            
            // Invent√°rio
            const inventoryList = document.getElementById('inventoryList');
            inventoryList.innerHTML = classData.inventory.map((item, index) => `
                <div class="inventory-item" id="inv_${index}">
                    <span>${item}</span>
                    <button class="remove-btn" onclick="removeInventoryItem(${index})">Remover</button>
                </div>
            `).join('');
        }

        function calculateValues() {
            if (!selectedClass) return;
            
            const classData = classes[selectedClass];
            const level = parseInt(document.getElementById('level').value) || 1;
            
            // Evas√£o base + modificadores de armadura
            let evasion = classData.evasion;
            if (classData.armor.features && classData.armor.features.includes('Flex√≠vel')) {
                evasion += 1;
            }
            if (classData.armor.features && classData.armor.features.includes('Pesada')) {
                evasion -= 1;
            }
            document.getElementById('evasion').value = evasion;
            
            // Armadura
            let armorScore = classData.armor.score;
            if (classData.secondaryWeapon && classData.secondaryWeapon.features && 
                classData.secondaryWeapon.features.includes('Protetor')) {
                armorScore += 1;
            }
            document.getElementById('armorScore').value = armorScore;
            
            // Limiares de dano (base + n√≠vel)
            document.getElementById('threshold1').value = classData.armor.thresholds[0] + level;
            document.getElementById('threshold2').value = classData.armor.thresholds[1] + level;
            document.getElementById('threshold3').value = (classData.armor.thresholds[2] || 0) + level;
        }

        function addInventoryItem() {
            const inventoryList = document.getElementById('inventoryList');
            const newItem = prompt('Digite o nome do novo item:');
            if (newItem) {
                const index = inventoryList.children.length;
                const itemDiv = document.createElement('div');
                itemDiv.className = 'inventory-item';
                itemDiv.id = `inv_${index}`;
                itemDiv.innerHTML = `
                    <span>${newItem}</span>
                    <button class="remove-btn" onclick="removeInventoryItem(${index})">Remover</button>
                `;
                inventoryList.appendChild(itemDiv);
            }
        }

        function removeInventoryItem(index) {
            const item = document.getElementById(`inv_${index}`);
            if (item) {
                item.remove();
            }
        }

        function resetForm() {
            if (confirm('Tem certeza que deseja resetar toda a ficha?')) {
                document.getElementById('characterSheet').classList.remove('active');
                document.querySelectorAll('.class-card').forEach(card => {
                    card.classList.remove('selected');
                });
                selectedClass = null;
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function downloadPDF() {
            const element = document.getElementById('characterSheet');
            const charName = document.getElementById('charName').value || 'Personagem';
            const classData = classes[selectedClass];
            
            const opt = {
                margin: 10,
                filename: `Ficha_${charName}_${classData.name}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };
            
            // Esconder bot√µes antes de gerar PDF
            const actions = document.querySelector('.actions');
            actions.style.display = 'none';
            
            html2pdf().set(opt).from(element).save().then(() => {
                actions.style.display = 'block';
            });
        }

        // Inicializar ao carregar
        window.onload = () => {
            initClassGrid();
        };

        // Atualizar valores quando o n√≠vel mudar
        document.getElementById('level')?.addEventListener('change', calculateValues);
    </script>
</body>
</html>
